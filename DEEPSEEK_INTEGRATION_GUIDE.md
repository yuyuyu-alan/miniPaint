# 🤖 DeepSeek AI 集成指南

## 📋 概述

本指南详细介绍如何在miniPaint中使用DeepSeek AI进行自然语言驱动的图像编辑。通过DeepSeek的强大语言理解能力，用户可以用中文自然语言描述来控制图像编辑操作。

## 🚀 快速开始

### 1. 安装依赖
```bash
# 安装依赖包
pnpm install
```

### 2. 获取DeepSeek API Key
1. 访问 [DeepSeek官网](https://platform.deepseek.com)
2. 注册账号并获取API Key (格式: sk-xxxxxxxx)
3. 确保账户有足够的余额

### 3. 启动应用
```bash
pnpm dev
```

### 4. 使用DeepSeek功能
1. 打开应用 `http://localhost:5173`
2. 点击右侧面板的 "🤖 AI测试" 标签
3. 选择 "🤖 DeepSeek" 标签页
4. 输入您的DeepSeek API Key
5. 开始用中文自然语言进行图像编辑！

### 5. 测试API连接
在浏览器控制台中运行：
```javascript
// 测试单个指令
testDeepSeekAPI("your-api-key", "创建一个800x600的画布，画一个红色圆形")

// 运行完整测试套件
runDeepSeekTests("your-api-key")
```

## 💬 支持的自然语言指令

### 🎨 画布操作
```
"创建一个800x600的画布"
"设置画布尺寸为1024x768"
"设置白色背景"
"背景改为浅蓝色"
```

### 🔵 图形绘制
```
"画一个红色圆形"
"在坐标(200,200)画一个半径100的蓝色圆"
"画一个绿色矩形"
"绘制一个200x150的黄色矩形在(100,100)"
```

### ✏️ 文字添加
```
"添加文字'Hello World'"
"在(300,200)位置添加文字'AI Generated'"
"添加大小32的粗体文字'标题'"
```

### 🏢 Logo设计
```
"创建一个Logo，公司名称'TechCorp'"
"设计一个简单的Logo"
"制作公司'AI Corp'的标志"
```

### 📐 图层管理
```
"创建一个新图层"
"创建名为'背景层'的图层"
"删除当前图层"
```

## 🎯 使用示例

### 示例1：创建简单图形
**用户输入：**
```
创建800x600画布，画一个红色圆形在中心
```

**AI执行：**
1. 设置画布尺寸为800x600
2. 在(400,300)绘制红色圆形

### 示例2：Logo设计
**用户输入：**
```
设计一个Logo，公司名称'创新科技'，蓝色背景
```

**AI执行：**
1. 设置400x400画布
2. 绘制蓝色圆形背景
3. 添加白色公司名称文字
4. 添加标语文字

### 示例3：复杂布局
**用户输入：**
```
画三个不同颜色的矩形，水平排列，分别是红色、绿色、蓝色
```

**AI执行：**
1. 绘制红色矩形在左侧
2. 绘制绿色矩形在中间
3. 绘制蓝色矩形在右侧

## 🔧 技术实现

### 架构组件
```
src/api/deepseek-adapter.ts     # DeepSeek API适配器
src/components/DeepSeekIntegration.tsx  # 用户界面组件
```

### 核心流程
1. **自然语言解析**: 用户输入 → DeepSeek API → 结构化命令
2. **命令执行**: 结构化命令 → LLM桥接器 → 图像编辑API
3. **结果反馈**: 执行结果 → 用户界面显示

### API调用示例
```typescript
import { createDeepSeekAdapter } from '@/api/deepseek-adapter'

// 创建适配器
const adapter = createDeepSeekAdapter('your-api-key')

// 执行自然语言指令
const result = await adapter.executeNaturalLanguage('画一个红色圆形')

console.log(result.message) // "✅ 成功执行操作"
```

## 🛡️ 安全特性

### API Key管理
- 本地存储，不会上传到服务器
- 支持随时更换API Key
- 提供基础模式（无需API Key）

### 指令验证
- 严格的参数验证
- 恶意指令过滤
- 操作权限控制

### 错误处理
- 网络错误自动重试
- API限制友好提示
- 详细的错误日志

## 📊 功能对比

| 功能 | 基础模式 | 完整模式 (API Key) |
|------|----------|-------------------|
| 指令解析 | 内置规则 | DeepSeek AI |
| 语言理解 | 简单匹配 | 深度理解 |
| 复杂指令 | 有限支持 | 完全支持 |
| 上下文理解 | 不支持 | 支持 |
| 创意生成 | 不支持 | 支持 |

## 🎨 高级用法

### 复杂设计指令
```
"设计一个现代风格的名片：白色背景，左上角放公司Logo，
右下角放联系信息，使用蓝色作为主色调"
```

### 批量操作
```
"创建一个彩虹效果：画7个不同颜色的圆形，
从左到右排列，颜色按彩虹顺序"
```

### 样式指定
```
"添加标题文字'欢迎使用AI'，使用Arial字体，
大小48，粗体，居中对齐"
```

## 🔍 调试和故障排除

### 常见问题

**Q: API调用失败**
A: 检查API Key是否正确，网络连接是否正常

**Q: 指令不被理解**
A: 尝试更具体的描述，参考示例指令格式

**Q: 操作执行失败**
A: 检查参数是否合理（如坐标、尺寸等）

### 调试模式
```javascript
// 在浏览器控制台启用调试
localStorage.setItem('deepseek-debug', 'true')
```

### 日志查看
- 打开浏览器开发者工具
- 查看Console标签页
- 搜索"DeepSeek"相关日志

## 📈 性能优化

### 响应时间
- DeepSeek API调用: 1-3秒
- 本地指令解析: < 100ms
- 图像编辑执行: < 500ms

### 优化建议
1. 使用简洁明确的指令
2. 避免过于复杂的单次操作
3. 合理使用批量命令

## 🔮 未来扩展

### 计划功能
- [ ] 图像识别和分析
- [ ] 风格迁移指令
- [ ] 智能布局建议
- [ ] 多轮对话上下文
- [ ] 自定义指令模板

### 集成其他AI模型
```typescript
// 支持多种AI模型
const gptAdapter = createGPTAdapter(apiKey)
const claudeAdapter = createClaudeAdapter(apiKey)
const deepseekAdapter = createDeepSeekAdapter(apiKey)
```

## 💡 最佳实践

### 指令编写技巧
1. **具体明确**: "画一个红色圆形" 比 "画个图形" 更好
2. **包含参数**: 指定位置、大小、颜色等具体参数
3. **分步描述**: 复杂操作可以分成多个简单指令
4. **使用中文**: 支持自然的中文表达

### 工作流程建议
1. 先设置画布尺寸和背景
2. 创建必要的图层
3. 按顺序添加图形元素
4. 最后添加文字和装饰

## 📞 技术支持

### 获取帮助
- 查看内置的建议指令
- 参考本文档的示例
- 在GitHub提交Issue

### 社区资源
- [DeepSeek官方文档](https://platform.deepseek.com/docs)
- [miniPaint项目主页](https://github.com/viliusle/miniPaint)
- [AI图像编辑社区](https://github.com/your-repo)

## 🧪 API测试

### 测试脚本
项目包含完整的DeepSeek API测试脚本：[`src/test-deepseek.ts`](src/test-deepseek.ts)

### 测试步骤
1. 打开浏览器开发者工具
2. 在控制台中运行测试命令
3. 查看API调用结果和解析效果

### 测试用例
- 基础画布操作
- 图形绘制指令
- Logo设计任务
- 复杂布局创建
- 文字添加操作

## 🔧 故障排除

### API调用失败
1. **检查API Key**: 确保格式正确 (sk-xxxxxxxx)
2. **检查余额**: 确保DeepSeek账户有足够余额
3. **网络连接**: 确保能访问api.deepseek.com
4. **CORS问题**: 在生产环境中需要配置代理

### 指令不被理解
1. **使用中文**: DeepSeek对中文理解更好
2. **具体描述**: 提供详细的参数和位置信息
3. **参考示例**: 使用文档中的示例格式
4. **分步操作**: 复杂任务分解为简单步骤

### 基础模式回退
当API调用失败时，系统会自动回退到基础模式：
- 使用内置规则解析
- 功能有限但稳定
- 不需要网络连接

---

**版本**: v2.0
**更新时间**: 2025-01-03
**状态**: 真实API集成完成 ✅

🎉 **现在您可以使用真正的DeepSeek AI进行自然语言图像编辑了！**